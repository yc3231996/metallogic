app:
  description: ä¸ºç”¨æˆ·æä¾›æ•°æ®åˆ†æ
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: DataGPT
kind: app
version: 0.1.1
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
    opening_statement: ''
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: answer
      id: 1718975657163-false-1718976692870-target
      source: '1718975657163'
      sourceHandle: 'false'
      target: '1718976692870'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: llm
      id: 1720509395229-source-llm-target
      source: '1720509395229'
      sourceHandle: source
      target: llm
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: answer
      id: 1720543282463-source-1720539322719-target
      source: '1720543282463'
      sourceHandle: source
      target: '1720539322719'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: tool
      id: 1718975657163-true-1720460398281-target
      source: '1718975657163'
      sourceHandle: 'true'
      target: '1720460398281'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: answer
      id: 1720642171070-source-1720642800846-target
      source: '1720642171070'
      sourceHandle: source
      target: '1720642800846'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: tool
        targetType: llm
      id: 1720460398281-source-1720543282463-target
      source: '1720460398281'
      sourceHandle: source
      target: '1720543282463'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: answer
        targetType: llm
      id: 1720539322719-source-1720642171070-target
      source: '1720539322719'
      sourceHandle: source
      target: '1720642171070'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: if-else
      id: llm-source-1718975657163-target
      source: llm
      sourceHandle: source
      target: '1718975657163'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: start
        targetType: llm
      id: 1718856016769-source-1722064820821-target
      source: '1718856016769'
      sourceHandle: source
      target: '1722064820821'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: if-else
      id: 1722064820821-source-1722068092637-target
      source: '1722064820821'
      sourceHandle: source
      target: '1722068092637'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: tool
      id: 1722068092637-true-1721546630239-target
      source: '1722068092637'
      sourceHandle: 'true'
      target: '1721546630239'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: answer
      id: 1722068092637-false-1722068142718-target
      source: '1722068092637'
      sourceHandle: 'false'
      target: '1722068142718'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: tool
        targetType: knowledge-retrieval
      id: 1721546630239-source-1722433346222-target
      source: '1721546630239'
      sourceHandle: source
      target: '1722433346222'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: knowledge-retrieval
        targetType: code
      id: 1722433346222-source-1720509395229-target
      source: '1722433346222'
      sourceHandle: source
      target: '1720509395229'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: Start
        type: start
        variables:
        - label: workspace
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: workspace
      height: 90
      id: '1718856016769'
      position:
        x: -3491.2529070238197
        y: 763.7920111462672
      positionAbsolute:
        x: -3491.2529070238197
        y: 763.7920111462672
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - '1722433346222'
          - result
        desc: ''
        model:
          completion_params:
            temperature: 0.2
            top_p: 0.3
          mode: chat
          name: claude-3-5-sonnet-20240620
          provider: anthropic
        prompt_template:
        - id: 9d80a82a-a5c6-4c39-8ad9-3e66ef14be8e
          role: system
          text: "You are a SQL query generator. Your task is to create SQL queries\
            \ based on user requests and the provided database schema. Follow these\
            \ instructions carefully:\n\nAnalyze the user's request, the database\
            \ schema, and the provided term definitions with extreme rigor. Your goal\
            \ is to generate a SQL query that fulfills the user's request using the\
            \ available tables and columns in the database schema, while strictly\
            \ adhering to defined terms and avoiding assumptions.\n\nTo generate the\
            \ SQL query:\n\n1. Rigorously evaluate if the user's request can be answered\
            \ using the provided database schema and term definitions:\n   a. Identify\
            \ all required dimensions, measures, and conditions in the user's query.\n\
            \   b. For each identified element:\n      - First, check if there is\
            \ an exact match in the database schema (table or column name).\n    \
            \  - If not found in the schema, check the <term_definitions> section\
            \ for an exact match.\n      - Do not assume any relationships or meanings\
            \ for terms not explicitly defined in either the schema or <term_definitions>.\n\
            \   c. If a term is defined in <term_definitions>, use only the information\
            \ provided there to determine how to handle it in the query.\n   d. For\
            \ terms found in the schema or <term_definitions>, carefully consider\
            \ data type compatibility.\n   e. If ANY required element is not found\
            \ as an exact match in either the schema or <term_definitions>, immediately\
            \ classify the request as insufficient. Do not attempt to derive or infer\
            \ meanings for undefined terms.\n   f. In case of insufficiency, respond\
            \ with: \"ä»¥æˆ‘å½“å‰çš„çŸ¥è¯†ï¼Œè¿˜ä¸èƒ½å›ç­”æ‚¨çš„é—®é¢˜å“¦\", followed by a detailed explanation of\
            \ what specific terms or elements are not recognized, and why the request\
            \ cannot be fulfilled with the current schema and term definitions.\n\
            \   g. Only proceed to SQL generation if ALL required elements are accounted\
            \ for with exact matches, either directly from the schema or through the\
            \ provided term definitions.\n\n2. If the request is valid and properly\
            \ scoped, identify the relevant tables and columns from the schema that\
            \ correspond to the user's request. Use only the elements that have been\
            \ explicitly matched or defined.\n\n3. Determine the appropriate SQL operations\
            \ (SELECT, JOIN, WHERE, GROUP BY, ORDER, etc.) needed to retrieve the\
            \ requested data. For queries returning individual records or comparisons,\
            \ always include an ORDER BY clause to ensure consistent results, and\
            \ use LIMIT to restrict the number of returned rows, typically to 30 or\
            \ less, unless a specific larger number is requested.\n\n4. Construct\
            \ the SQL query using standard SQL syntax. If specific optimizations or\
            \ dialect-specific features (especially for date handling) are available\
            \ for the target database type, utilize them for better efficiency and\
            \ effectiveness. Incorporate calculations or subqueries for derived metrics\
            \ only if they are explicitly defined in <term_definitions>.\n\n5. If\
            \ the query involves time-related conditions, make use of the provided\
            \ current date information.\n\n6. Ensure that the query is optimized and\
            \ follows best practices, including proper handling of any complex calculations\
            \ or derivations based on the explicit term definitions.\n\nImportant:\
            \ If you generate a SQL query, your output must contain ONLY the generated\
            \ SQL query. Do not include any explanations, comments, or additional\
            \ text. The query will be executed directly, so it must be valid SQL syntax.\n\
            \nWrite your SQL query output without any surrounding tags or formatting.\
            \ Ensure it starts with a SQL keyword (e.g., SELECT, WITH, etc.) and ends\
            \ with a semicolon (;)."
        - id: 2076a444-86c2-4663-8b71-a9547dbdfdf5
          role: user
          text: 'here is the database schema information:

            <database_schema>

            {{#1721546630239.text#}}

            </database_schema>

            Additional context for specific terms or metrics: <term_definitions>

            {{#context#}}

            </term_definitions>

            here is the user''s data request:

            <user_request>

            {{#sys.query#}}

            </user_request>

            The target database type is:

            <database_type>

            POSTGRES

            </database_type>


            The current date is:

            <current_date>

            {{#1720509395229.current_date#}}

            </current_date>'
        selected: false
        title: Generate sql
        type: llm
        variables: []
        vision:
          configs:
            detail: high
          enabled: true
      height: 98
      id: llm
      position:
        x: -1307.5389491462806
        y: 654.9731907342522
      positionAbsolute:
        x: -1307.5389491462806
        y: 654.9731907342522
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: d2e37111-f0f5-4e72-a3fb-6df944dcdade
            value: SELECT
            varType: string
            variable_selector:
            - llm
            - text
          id: 'true'
          logical_operator: and
        conditions:
        - comparison_operator: contains
          id: '1718975743597'
          value: SELECT
          variable_selector:
          - llm
          - text
        desc: ''
        logical_operator: and
        selected: false
        title: IF/ELSE 2
        type: if-else
      height: 126
      id: '1718975657163'
      position:
        x: -918.0278832759379
        y: 654.9731907342522
      positionAbsolute:
        x: -918.0278832759379
        y: 654.9731907342522
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#llm.text#}}


          '
        desc: ä¸éœ€è¦æ‰§è¡ŒSQLï¼Œç›´æ¥å›ç­”
        selected: false
        title: direct answer no sql
        type: answer
        variables: []
      height: 135
      id: '1718976692870'
      position:
        x: -369.9830472903312
        y: 800.7833763894674
      positionAbsolute:
        x: -369.9830472903312
        y: 800.7833763894674
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        provider_id: 4d1e02ed-b1ac-47d1-8319-a6f014a1d240
        provider_name: Data Engine
        provider_type: api
        selected: false
        title: execute_sql_post
        tool_configurations: {}
        tool_label: execute_sql_post
        tool_name: execute_sql_post
        tool_parameters:
          sql:
            type: mixed
            value: '{{#llm.text#}}'
          workspace:
            type: mixed
            value: '{{#1718856016769.workspace#}}'
        type: tool
      height: 54
      id: '1720460398281'
      position:
        x: -362.5127102016905
        y: 474.3577238847362
      positionAbsolute:
        x: -362.5127102016905
        y: 474.3577238847362
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\ndef main() -> str:\n    from datetime import date\n    current_date\
          \ = date.today()\n    return {\n        \"current_date\": str(current_date)\n\
          \    }\n"
        code_language: python3
        desc: ''
        outputs:
          current_date:
            children: null
            type: string
        selected: false
        title: current time
        type: code
        variables: []
      height: 54
      id: '1720509395229'
      position:
        x: -1671.4216501201104
        y: 654.9731907342522
      positionAbsolute:
        x: -1671.4216501201104
        y: 654.9731907342522
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1720543282463.text#}}


          '
        desc: ''
        selected: false
        title: execution output
        type: answer
        variables: []
      height: 107
      id: '1720539322719'
      position:
        x: 711.6075882354751
        y: 465.6522182517749
      positionAbsolute:
        x: 711.6075882354751
        y: 465.6522182517749
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.2
            top_p: 0.2
          mode: chat
          name: gpt-4o-mini-2024-07-18
          provider: openai
        prompt_template:
        - id: 838765c1-ba07-4f61-8f18-06439c70c190
          role: system
          text: "ä½ æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹,è´Ÿè´£ä»¥æ›´å‹å¥½çš„æ ¼å¼å‘ˆç°SQLæŸ¥è¯¢ä¿¡æ¯ã€‚ä½ çš„ç›®æ ‡æ˜¯ä½¿è¾“å‡ºæ›´æ˜“è¯»å’Œç®€æ´ã€‚è¯·ä»”ç»†éµå¾ªä»¥ä¸‹æŒ‡ç¤º:\n1. æ ¼å¼åŒ–SQLè¯­å¥:\n\
            åœ¨Markdownä»£ç å—ä¸­è¾“å‡ºSQLè¯­å¥\næ”¹è¿›SQLçš„æ ¼å¼ä»¥æé«˜å¯è¯»æ€§(ä¾‹å¦‚,é€‚å½“çš„ç¼©è¿›ã€æ¢è¡Œ)\nç¤ºä¾‹:\n```sql\nCopySELECT\
            \ column1, column2 \nFROM table \nWHERE condition;\n```\n2. è®°ä½:\nå§‹ç»ˆä½¿ç”¨Markdownæ ¼å¼æ¥å±•ç¤ºç»“æœã€‚\n\
            é™¤éç‰¹åˆ«æŒ‡ç¤º,å¦åˆ™ä¸è¦åŒ…å«è§£é‡Šæˆ–é¢å¤–å›ç­”ï¼Œç¡®ä¿ä½ çš„è¾“å‡ºæ¸…æ™°æ˜“è¯»\n\nå§‹ç»ˆç”¨ä¸­æ–‡å›ç­”"
        - id: 46f82c63-c339-42a8-a80a-e1916b70bb85
          role: user
          text: '<sql_statement>

            {{#llm.text#}}

            </sql_statement>'
        selected: false
        title: execution summarize
        type: llm
        variables: []
        vision:
          configs:
            detail: high
          enabled: true
      height: 98
      id: '1720543282463'
      position:
        x: 195.80740200345332
        y: 474.3577238847362
      positionAbsolute:
        x: 195.80740200345332
        y: 474.3577238847362
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.3
            top_p: 0.4
          mode: chat
          name: claude-3-5-sonnet-20240620
          provider: anthropic
        prompt_template:
        - id: e2593233-9320-48fd-8bd3-28d44441ef03
          role: system
          text: "æ‚¨æ˜¯ä¸€ä½äººå·¥æ™ºèƒ½åŠ©æ‰‹,è´Ÿè´£å¸®åŠ©ç”¨æˆ·æ ¹æ®ä»–ä»¬çš„è¯·æ±‚å¯è§†åŒ–æ•°æ®ã€‚\næ‚¨çš„ç›®æ ‡æ˜¯åˆ†ææ•°æ®ç»“æœ,å¹¶ä½¿ç”¨EChartsæä¾›é€‚å½“çš„å¯è§†åŒ–,æˆ–è€…åœ¨ä¸é€‚åˆå¯è§†åŒ–çš„æƒ…å†µä¸‹ç›´æ¥è¾“å‡ºæ•°æ®ã€‚è¯·å§‹ç»ˆç”¨ä¸­æ–‡å›ç­”ã€‚\n\
            é¦–å…ˆ,åˆ†ææ•°æ®ç»“æœä»¥ç¡®å®šå…¶æ˜¯å¦é€‚åˆå¯è§†åŒ–ã€‚è€ƒè™‘ä»¥ä¸‹æƒ…å†µ:\n1. å¦‚æœæ•°æ®ç»“æœä¸ºç©ºï¼Œä»…è¾“å‡ºï¼š\"æ²¡æœ‰æŸ¥è¯¢åˆ°æ•°æ®\"ï¼Œç„¶åç«‹å³ç»“æŸå¤„ç†ï¼Œä¸è¦æ·»åŠ ä»»ä½•è§£é‡Šæˆ–å»ºè®®ã€‚\n\
            2. å¦‚æœæ•°æ®ç»“æœæ˜¯å•ä¸ªå€¼ï¼Œç›´æ¥è¾“å‡ºè¯¥å€¼ã€‚\n3. å¦‚æœæ•°æ®ç»“æœåŒ…å«å¤šè¡Œæ•°æ®ï¼Œä¸”é€‚åˆç”¨è¡¨æ ¼å±•ç¤ºçš„ï¼Œç”¨MARKDOWNçš„æ ¼å¼è¾“å‡ºè¡¨æ ¼ã€‚\n4.\
            \ å¦‚æœæ•°æ®ç»“æœåŒ…å«å¤šä¸ªæ•°æ®ç‚¹æˆ–å¤æ‚ç»“æ„ï¼Œé€‚åˆè¿›è¡Œå›¾è¡¨å±•ç¤ºçš„æƒ…å†µï¼Œè¯·ç»§ç»­è¿›è¡Œå¯è§†åŒ–ã€‚\n\nå¯è§†åŒ–è¿‡ç¨‹è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤:\n1. ç®€è¦è¯´æ˜æ‚¨è®¡åˆ’å¦‚ä½•å¯è§†åŒ–æ•°æ®ã€‚æ³¨æ„è¦éµå¾ªç”¨æˆ·çš„è¯·æ±‚ï¼Œå¯è§†åŒ–è¦è´´åˆç”¨æˆ·è¯·æ±‚ä¸­çš„è¦æ±‚ï¼Œæ¯”å¦‚å›¾è¡¨ç±»å‹ï¼Œæ—¶é—´èŒƒå›´ï¼Œæ˜¾ç¤ºçš„ä¿¡æ¯ã€‚å¦‚æœè¯·æ±‚ä¸­æ²¡æœ‰æ˜ç¡®è¯´æ˜ï¼Œä½ å¯ä»¥è¿›è¡Œæ¨æ–­ã€‚\n\
            2. åˆ›å»ºEChartsé…ç½®ã€‚æ³¨æ„è€ƒè™‘æ·»åŠ å·¥å…·æç¤ºã€å›¾ä¾‹å’Œæ ‡ç­¾ç­‰è§†è§‰å…ƒç´ ä»¥æé«˜å›¾è¡¨çš„å¯è¯»æ€§ã€‚\n3. åœ¨é…ç½®ä¹‹å,æä¾›å›¾è¡¨çš„ç®€çŸ­æè¿°,è§£é‡Šåæ ‡è½´æˆ–å„éƒ¨åˆ†ä»£è¡¨çš„å«ä¹‰ã€‚\n\
            è¯·ä»¥ä¸‹é¢æ ¼å¼è¾“å‡ºEChartsé…ç½®å­—ç¬¦ä¸²:\n```chart\n{\n// Your ECharts configuration here\n\
            }\n```\n\nImportantï¼šè¯·ç¡®ä¿è¾“å‡ºçš„Echartsé…ç½®ä»¥ä¸‰ä¸ªåå¼•å·åè·Ÿ\"chart\"å¼€å§‹,å¹¶ä»¥ä¸‰ä¸ªåå¼•å·ç»“æŸ.\né€šå¸¸å®Œæ•´çš„Echartsé…ç½®ä¼šåŒ…å«ä¸‹é¢å…ƒç´ ï¼š\n\
            1. å›¾è¡¨ç±»å‹(å¦‚æŠ˜çº¿å›¾ã€æŸ±çŠ¶å›¾ã€é¥¼å›¾ã€æ•£ç‚¹å›¾)\n2. åŒ…å«æä¾›æ•°æ®çš„æ•°æ®é›†,æˆ–ç³»åˆ—ä¸­çš„æ•°æ®\n3. Xè½´å’ŒYè½´é…ç½®\n4. ç³»åˆ—é…ç½®\n\
            5. å·¥å…·æç¤ºå’Œå›¾ä¾‹(å¦‚é€‚ç”¨)\n6. ä»»ä½•å…¶ä»–ç›¸å…³é€‰é¡¹ä»¥æ”¹å–„å¯è§†åŒ–æ•ˆæœ\n\nç¡®ä¿å°½é‡è´´åˆç”¨æˆ·è¯·æ±‚ä¸­çš„è¦æ±‚ï¼Œå°¤å…¶æ˜¯å›¾è¡¨ç±»å‹å’Œæ—¶é—´èŒƒå›´ã€‚\n\
            ä»…åœ¨å®Œæˆå¯è§†åŒ–åï¼Œæä¾›ä¸€ä¸ªç®€çŸ­çš„å›¾è¡¨æè¿°ï¼Œè§£é‡Šåæ ‡è½´æˆ–å„éƒ¨åˆ†ä»£è¡¨çš„å«ä¹‰ã€‚ä¿æŒè¿™ä¸ªæè¿°ç®€æ´ï¼ŒåªåŒ…å«å¿…è¦çš„ä¿¡æ¯ã€‚\n\nä»¥ä¸‹æ˜¯å¤„ç†ä¸åŒæƒ…å†µçš„ä¸€äº›ç¤ºä¾‹ï¼š\n\
            1. Empty dataset:\n<data_result>\n{\"data\":[]}\n</data_result>\nOutput:\
            \ æ•°æ®é›†ä¸ºç©º\n2. Single value:\n<data_result>\n{\"data\":42}\n</data_result>\n\
            Output: 42\n3. Multiple data points (line chart):\n<data_result>\n{\"\
            data\":[data set goes here]}\n</data_result>\nOutput:\næˆ‘å°†ä½¿ç”¨æŠ˜çº¿å›¾æ¥å¯è§†åŒ–æœˆåº¦é”€å”®æ•°æ®ï¼Œxè½´è¡¨ç¤ºæœˆä»½ï¼Œyè½´è¡¨ç¤ºé”€å”®é¢ã€‚\n\
            ```chart\n{\n\"tooltip\": { \"trigger\": \"axis\" },\n\"dataset\": {\n\
            \"source\": [\n[\"month\", \"sales\"],\n[\"Jan\", 1000],\n[\"Feb\", 1200],\n\
            [\"Mar\", 900],\n[\"Apr\", 1500],\n[\"May\", 1300],\n[\"Jun\", 1700]\n\
            ]\n},\n\"xAxis\": { \"type\": \"category\" },\n\"yAxis\": { \"type\":\
            \ \"value\", \"name\": \"Sales\" },\n\"series\": [\n{\n\"type\": \"line\"\
            ,\n\"encode\": { \"x\": \"month\", \"y\": \"sales\" }\n}\n]\n}\n```\n\
            è¿™ä¸ªæŠ˜çº¿å›¾å±•ç¤ºäº†å…­ä¸ªæœˆçš„é”€å”®è¶‹åŠ¿ã€‚æ¨ªè½´ï¼ˆxè½´ï¼‰è¡¨ç¤ºæœˆä»½ï¼Œä»ä¸€æœˆåˆ°å…­æœˆï¼›çºµè½´ï¼ˆyè½´ï¼‰è¡¨ç¤ºé”€å”®é¢ï¼Œå•ä½å¯èƒ½æ˜¯ç¾å…ƒæˆ–å…¶ä»–è´§å¸ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é”€å”®é¢åœ¨ä¸åŒæœˆä»½æœ‰æ‰€æ³¢åŠ¨ï¼Œå››æœˆè¾¾åˆ°äº†æœ€é«˜ç‚¹ã€‚\n\
            4. Categorical data (bar chart):\n<data_result>\n{\"data\":[data set goes\
            \ here]}\n</data_result>\nOutput:\næˆ‘å°†ä½¿ç”¨æŸ±çŠ¶å›¾æ¥å¯è§†åŒ–ä¸åŒäº§å“çš„é”€å”®æ•°æ®ï¼Œxè½´è¡¨ç¤ºäº§å“åç§°ï¼Œyè½´è¡¨ç¤ºé”€å”®é¢ã€‚\n\
            ```chart\n{\n\"tooltip\": { \"trigger\": \"axis\" },\n\"xAxis\": { \"\
            type\": \"category\" },\n\"yAxis\": { \"type\": \"value\", \"name\": \"\
            Sales\" },\n\"dataset\": {\n\"source\": [\n[\"product\", \"sales\"],\n\
            [\"Matcha Latte\", 43.3],\n[\"Milk Tea\", 83.1],\n[\"Cheese Cocoa\", 86.4],\n\
            [\"Walnut Brownie\", 72.4]\n]\n},\n\"series\": [\n{\n\"type\": \"bar\"\
            ,\n\"encode\": { \"x\": \"product\", \"y\": \"sales\" }\n}\n]\n}\n```\n\
            è¿™ä¸ªæŸ±çŠ¶å›¾å±•ç¤ºäº†å››ç§ä¸åŒäº§å“çš„é”€å”®æƒ…å†µã€‚æ¨ªè½´ï¼ˆxè½´ï¼‰è¡¨ç¤ºäº§å“åç§°ï¼ŒåŒ…æ‹¬æŠ¹èŒ¶æ‹¿é“ã€å¥¶èŒ¶ã€èŠå£«å¯å¯å’Œæ ¸æ¡ƒå¸ƒæœ—å°¼ï¼›çºµè½´ï¼ˆyè½´ï¼‰è¡¨ç¤ºé”€å”®é¢ï¼Œå•ä½å¯èƒ½æ˜¯æ•°é‡æˆ–é‡‘é¢ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒèŠå£«å¯å¯çš„é”€å”®é¢æœ€é«˜ï¼Œè€ŒæŠ¹èŒ¶æ‹¿é“çš„é”€å”®é¢æœ€ä½ã€‚\n\
            5. Proportional data (pie chart):\n<data_result>\n{\"data\":[data set\
            \ goes here]}\n</data_result>\nOutput:\næˆ‘å°†ä½¿ç”¨é¥¼å›¾æ¥å¯è§†åŒ–ä¸åŒæ¸ é“çš„è®¿é—®é‡åˆ†å¸ƒï¼Œæ¯ä¸ªæ‰‡å½¢åŒºåŸŸä»£è¡¨ä¸€ä¸ªæ¸ é“çš„è®¿é—®é‡å æ¯”ã€‚\n\
            ```chart\n{\n\"tooltip\": {\n\"trigger\": \"item\",\n\"formatter\": \"\
            {a} <br/>{b}: {c} ({d}%)\"\n},\n\"legend\": {\n\"orient\": \"vertical\"\
            ,\n\"left\": \"left\"\n},\n\"dataset\": {\n\"source\": [\n[\"category\"\
            , \"value\"],\n[\"Direct\", 335],\n[\"Email\", 310],\n[\"Ad Networks\"\
            , 234],\n[\"Video Ads\", 135],\n[\"Search Engines\", 1548]\n]\n},\n\"\
            series\": [{\n\"name\": \"Access From\",\n\"type\": \"pie\",\n\"radius\"\
            : \"50%\",\n\"encode\": {\n\"itemName\": \"category\",\n\"value\": \"\
            value\"\n},\n\"label\": {\n\"formatter\": \"{b}: {d}%\"\n}\n}]\n}\n```\n\
            Remember to adapt the chart configuration based on the specific data structure\
            \ and user request. Always prioritize clarity and readability in your\
            \ visualizations.\nHere are more knowledge of EChart configuration you\
            \ can refer to when generate complex chart.\n## BAR and LINE Combination\
            \ Chart\noutput:\n```chart\n{\n    \"tooltip\": {\n        \"trigger\"\
            : \"axis\",\n        \"axisPointer\": {\n            \"type\": \"cross\"\
            ,\n            \"crossStyle\": {\n                \"color\": \"#999\"\n\
            \            }\n        }\n    },\n    \"legend\": {\n        \"data\"\
            : [\"Sales\", \"Profit Margin\"]\n    },\n    \"xAxis\": [\n        {\n\
            \            \"type\": \"category\",\n            \"data\": [\"Jan\",\
            \ \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\"\
            , \"Oct\", \"Nov\", \"Dec\"],\n            \"axisPointer\": {\n      \
            \          \"type\": \"shadow\"\n            }\n        }\n    ],\n  \
            \  \"yAxis\": [\n        {\n            \"type\": \"value\",\n       \
            \     \"name\": \"Sales\",\n            \"min\": 0,\n            \"max\"\
            : 250,\n            \"interval\": 50,\n            \"axisLabel\": {\n\
            \                \"formatter\": \"{value} k$\"\n            }\n      \
            \  },\n        {\n            \"type\": \"value\",\n            \"name\"\
            : \"Profit Margin\",\n            \"min\": 0,\n            \"max\": 25,\n\
            \            \"interval\": 5,\n            \"axisLabel\": {\n        \
            \        \"formatter\": \"{value}%\"\n            }\n        }\n    ],\n\
            \    \"series\": [\n        {\n            \"name\": \"Sales\",\n    \
            \        \"type\": \"bar\",\n            \"data\": [120, 132, 101, 134,\
            \ 90, 230, 210, 182, 191, 234, 290, 330]\n        },\n        {\n    \
            \        \"name\": \"Profit Margin\",\n            \"type\": \"line\"\
            ,\n            \"yAxisIndex\": 1,\n            \"data\": [10, 12, 8, 14,\
            \ 7, 18, 15, 13, 14, 16, 20, 22]\n        }\n    ]\n}\n```\n## Line Chart\
            \ with Multiple Y-Axes\nThis example demonstrates a line chart with two\
            \ y-axes, showing temperature and precipitation data for a week.\noutput:\n\
            ```chart\n{\n    \"legend\": { \"data\": [\"Temperature\", \"Precipitation\"\
            ], \"top\": \"top\" },\n    \"tooltip\": { \"trigger\": \"axis\" },\n\
            \    \"dataset\": {\n        \"source\": [\n            [\"date\", \"\
            temperature\", \"precipitation\"],\n            [\"Mon\", 22, 2.6],\n\
            \            [\"Tue\", 24, 5.9],\n            [\"Wed\", 27, 9.0],\n  \
            \          [\"Thu\", 23, 26.4],\n            [\"Fri\", 21, 28.7],\n  \
            \          [\"Sat\", 25, 70.7],\n            [\"Sun\", 26, 175.6]\n  \
            \      ]\n    },\n    \"xAxis\": { \"type\": \"category\" },\n    \"yAxis\"\
            : [\n        { \"type\": \"value\", \"name\": \"Temperature (Â°C)\", \"\
            position\": \"left\" },\n        { \"type\": \"value\", \"name\": \"Precipitation\
            \ (mm)\", \"position\": \"right\" }\n    ],\n    \"series\": [\n     \
            \   {\n            \"name\": \"Temperature\",\n            \"type\": \"\
            line\",\n            \"encode\": { \"x\": \"date\", \"y\": \"temperature\"\
            \ },\n            \"yAxisIndex\": 0\n        },\n        {\n         \
            \   \"name\": \"Precipitation\",\n            \"type\": \"line\",\n  \
            \          \"encode\": { \"x\": \"date\", \"y\": \"precipitation\" },\n\
            \            \"yAxisIndex\": 1\n        }\n    ]\n}\n```\n## Scatter Plot\n\
            Scatter plots are crucial for visualizing relationships between two variables\
            \ and identifying patterns or correlations.\noutput:\n```chart\n{\n  \
            \  \"tooltip\": {\n        \"trigger\": \"item\",\n        \"formatter\"\
            : function (params) {\n            return 'Height: ' + params.data[0]\
            \ + ' cm<br/>Weight: ' + params.data[1] + ' kg';\n        }\n    },\n\
            \    \"xAxis\": {\n        \"type\": \"value\",\n        \"name\": \"\
            Height (cm)\"\n    },\n    \"yAxis\": {\n        \"type\": \"value\",\n\
            \        \"name\": \"Weight (kg)\"\n    },\n    \"series\": [{\n     \
            \   \"type\": \"scatter\",\n        \"data\": [\n            [168, 65],\
            \ [170, 70], [165, 60], [175, 80], [172, 75],\n            [160, 55],\
            \ [180, 85], [170, 68], [175, 76], [165, 63]\n        ],\n        \"symbolSize\"\
            : 10\n    }]\n}\n```"
        - id: ed423505-66a4-4bb2-84f7-18107ec53ef4
          role: user
          text: 'Here is the user''s data request:

            <user_request>

            {{#sys.query#}}

            </user_request>

            And here is the corresponding data result:

            <data_result>

            {{#1720460398281.text#}}

            </data_result>'
        selected: true
        title: chart prepare
        type: llm
        variables: []
        vision:
          configs:
            detail: high
          enabled: true
      height: 98
      id: '1720642171070'
      position:
        x: 1148.8057080225067
        y: 474.3577238847362
      positionAbsolute:
        x: 1148.8057080225067
        y: 474.3577238847362
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1720642171070.text#}}


          '
        desc: ''
        selected: false
        title: display chart options
        type: answer
        variables: []
      height: 107
      id: '1720642800846'
      position:
        x: 1596.9065154825269
        y: 474.3577238847362
      positionAbsolute:
        x: 1596.9065154825269
        y: 474.3577238847362
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        provider_id: 4d1e02ed-b1ac-47d1-8319-a6f014a1d240
        provider_name: Data Engine
        provider_type: api
        selected: false
        title: workspacemetadata_get
        tool_configurations: {}
        tool_label: workspacemetadata_get
        tool_name: workspacemetadata_get
        tool_parameters:
          workspace:
            type: mixed
            value: '{{#1718856016769.workspace#}}'
        type: tool
      height: 54
      id: '1721546630239'
      position:
        x: -2258.625046633063
        y: 654.9731907342522
      positionAbsolute:
        x: -2258.625046633063
        y: 654.9731907342522
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.5
            top_p: 0.4
          mode: chat
          name: qwen-max-0403
          provider: tongyi
        prompt_template:
        - id: 2afad292-1688-4dbd-99cd-07771fd36a2d
          role: system
          text: "# AIæ•°æ®åˆ†æåŠ©æ‰‹æç¤ºè¯\n\nä½ æ˜¯ä¸€ä½AIæ•°æ®åˆ†æåŠ©æ‰‹ï¼Œè´Ÿè´£åˆæ­¥ç­›é€‰ä¸æ•°æ®æŸ¥è¯¢å’Œåˆ†æç›¸å…³çš„ç”¨æˆ·è¯·æ±‚ã€‚ä½ çš„ä»»åŠ¡æ˜¯åˆ¤æ–­è¯·æ±‚çš„ç›¸å…³æ€§ã€å¤æ‚åº¦å’Œå¯èƒ½çš„æ•°æ®é‡ï¼Œä¸æ¶‰åŠä»»ä½•å…·ä½“çš„ä¸šåŠ¡é€»è¾‘åˆ¤æ–­ã€‚\n\
            \nè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼š\n\n1. åˆ†æç”¨æˆ·è¯·æ±‚ï¼Œåˆ¤æ–­æ˜¯å¦ä¸æ•°æ®æŸ¥è¯¢æˆ–åˆ†æç›¸å…³ã€‚å…³æ³¨æ•°æ®ã€ç»Ÿè®¡ã€æ•°å­—æˆ–åˆ†æä»»åŠ¡ç›¸å…³çš„å…³é”®è¯ã€‚\n\n\
            2. å¦‚æœè¯·æ±‚ä¸æ•°æ®æŸ¥è¯¢æˆ–åˆ†ææ— å…³ï¼Œå›å¤ï¼š\n   \"æˆ‘åªèƒ½å›ç­”æ•°æ®æ–¹é¢çš„è¯·æ±‚å“¦ï¼\"\n\n3. å¦‚æœè¯·æ±‚ç›¸å…³ï¼Œè¯„ä¼°ä»¥ä¸‹ä¸¤ç‚¹ï¼š\n\n\
            \   a. å¤æ‚åº¦ï¼šåˆ¤æ–­è¯·æ±‚æ˜¯å¦å¤æ‚åˆ°æ— æ³•ç”¨ä¸€ä¸ªSQLæŸ¥è¯¢å’Œä¸€ä¸ªå›¾è¡¨æ¥å›ç­”ã€‚å¦‚æœæ˜¯ï¼Œå›å¤ï¼š\n   \"æ‚¨çš„é—®é¢˜æ¯”è¾ƒå¤æ‚ï¼Œå¦‚æœä½ èƒ½ç®€åŒ–ä¸€ä¸‹ï¼Œæˆ–è€…åˆ†æ­¥æå‡ºé—®é¢˜ï¼Œæˆ‘å¯èƒ½ä¼šå›ç­”çš„æ›´å‡†ç¡®å“¦ï¼\"\
            \n\n   b. æ•°æ®é‡ï¼šè¯„ä¼°è¯·æ±‚æ˜¯å¦å¯èƒ½è¿”å›å¤§é‡æ•°æ®ï¼ˆå¯èƒ½è¶…è¿‡1000æ¡è®°å½•ï¼‰ã€‚ä»¥ä¸‹æƒ…å†µå¯èƒ½å¯¼è‡´å¤§é‡æ•°æ®è¿”å›ï¼š\n      - æŒ‡å®šçš„æ—¶é—´èŒƒå›´è¿‡å¤§ï¼ˆå¦‚\"\
            å»å¹´\"ã€\"è¿‡å»ä¸‰å¹´\"ã€\"æ‰€æœ‰\"ç­‰ï¼‰ï¼Œä¸”æ²¡æœ‰ç”¨èšåˆï¼Œæˆ–è€…èšåˆçš„é¢—ç²’åº¦å¤ªç»†ï¼Œå¯¼è‡´å¯èƒ½ä¼šè¿”å›å¤§é‡ç»“æœã€‚\n      - éèšåˆçš„å…¨é‡æ•°æ®è¯·æ±‚ï¼ˆå¦‚\"\
            æ‰€æœ‰è®°å½•\"ã€\"è¯¦ç»†æ•°æ®\"ç­‰ï¼‰\n   å¦‚æœç¬¦åˆä»¥ä¸Šä»»ä¸€æƒ…å†µï¼Œå›å¤ï¼š\n   \"æ‚¨çš„è¯·æ±‚å¯èƒ½ä¼šè¿”å›å¤§é‡æ•°æ®ã€‚å»ºè®®æ‚¨ç¼©å°æŸ¥è¯¢èŒƒå›´æˆ–å¢åŠ ç­›é€‰æ¡ä»¶ï¼Œä¾‹å¦‚æŒ‡å®šæ›´å°çš„æ—¶é—´æ®µæˆ–æ·»åŠ å…¶ä»–é™åˆ¶æ¡ä»¶ã€‚\"\
            \n\n4. å¦‚æœè¯·æ±‚æ˜¯ç›¸å…³çš„æ•°æ®æŸ¥è¯¢æˆ–åˆ†æè¯·æ±‚ï¼Œä¸”ä¸å­˜åœ¨ä¸Šè¿°å¤æ‚åº¦å’Œæ•°æ®é‡é—®é¢˜ï¼Œåˆ™ä»…è¾“å‡ºï¼š\n   VALID REQUEST\n\næ³¨æ„ï¼šé™¤äº†ä»¥ä¸ŠæŒ‡å®šçš„å›å¤ï¼Œä¸è¦æä¾›ä»»ä½•å…¶ä»–å»ºè®®æˆ–è§£é‡Šã€‚åœ¨è¾“å‡ºVALID\
            \ REQUESTæ—¶ï¼Œä¸è¦æ·»åŠ ä»»ä½•é¢å¤–å†…å®¹ã€‚"
        - id: 5afba990-f2fb-42fc-aa68-032e557fb24f
          role: user
          text: ä»¥ä¸‹æ˜¯ç”¨æˆ·è¯·æ±‚:{{#sys.query#}}
        selected: false
        title: request process
        type: llm
        variables: []
        vision:
          enabled: false
      height: 98
      id: '1722064820821'
      position:
        x: -3049.6817627417436
        y: 763.7920111462672
      positionAbsolute:
        x: -3049.6817627417436
        y: 763.7920111462672
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: a5384aee-47a4-411a-9f52-deef9af19cd8
            value: VALID REQUEST
            varType: string
            variable_selector:
            - '1722064820821'
            - text
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: IF/ELSE 3
        type: if-else
      height: 126
      id: '1722068092637'
      position:
        x: -2642.8613718033494
        y: 763.7920111462672
      positionAbsolute:
        x: -2642.8613718033494
        y: 763.7920111462672
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1722064820821.text#}}'
        desc: ''
        selected: false
        title: Answer 7
        type: answer
        variables: []
      height: 107
      id: '1722068142718'
      position:
        x: -2226.4480190267054
        y: 957.6982268439423
      positionAbsolute:
        x: -2226.4480190267054
        y: 957.6982268439423
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        dataset_ids:
        - 7503dbc5-31b9-43b7-a6a1-e0f4bff2b4b4
        desc: ''
        multiple_retrieval_config:
          reranking_model:
            model: ''
            provider: ''
          score_threshold: null
          top_k: 2
        query_variable_selector:
        - sys
        - query
        retrieval_mode: single
        selected: false
        single_retrieval_config:
          model:
            completion_params: {}
            mode: chat
            name: qwen-max-0403
            provider: tongyi
        title: term definitions
        type: knowledge-retrieval
      height: 92
      id: '1722433346222'
      position:
        x: -1947.5977337749903
        y: 545.9561506728106
      positionAbsolute:
        x: -1947.5977337749903
        y: 545.9561506728106
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: 35.08903217071065
      y: -128.8783178578185
      zoom: 0.5366869235799799
