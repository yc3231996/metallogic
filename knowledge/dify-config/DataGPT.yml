app:
  description: ‰∏∫Áî®Êà∑Êèê‰æõÊï∞ÊçÆÂàÜÊûê
  icon: ü§ñ
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: DataGPT
kind: app
version: 0.1.1
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
    opening_statement: ''
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: answer
      id: 1718975657163-false-1718976692870-target
      source: '1718975657163'
      sourceHandle: 'false'
      target: '1718976692870'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: llm
      id: 1720509395229-source-llm-target
      source: '1720509395229'
      sourceHandle: source
      target: llm
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: answer
      id: 1720543282463-source-1720539322719-target
      source: '1720543282463'
      sourceHandle: source
      target: '1720539322719'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: tool
      id: 1718975657163-true-1720460398281-target
      source: '1718975657163'
      sourceHandle: 'true'
      target: '1720460398281'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: answer
      id: 1720642171070-source-1720642800846-target
      source: '1720642171070'
      sourceHandle: source
      target: '1720642800846'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: tool
        targetType: llm
      id: 1720460398281-source-1720543282463-target
      source: '1720460398281'
      sourceHandle: source
      target: '1720543282463'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: answer
        targetType: llm
      id: 1720539322719-source-1720642171070-target
      source: '1720539322719'
      sourceHandle: source
      target: '1720642171070'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: if-else
      id: llm-source-1718975657163-target
      source: llm
      sourceHandle: source
      target: '1718975657163'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: start
        targetType: llm
      id: 1718856016769-source-1722064820821-target
      source: '1718856016769'
      sourceHandle: source
      target: '1722064820821'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: if-else
      id: 1722064820821-source-1722068092637-target
      source: '1722064820821'
      sourceHandle: source
      target: '1722068092637'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: tool
      id: 1722068092637-true-1721546630239-target
      source: '1722068092637'
      sourceHandle: 'true'
      target: '1721546630239'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: answer
      id: 1722068092637-false-1722068142718-target
      source: '1722068092637'
      sourceHandle: 'false'
      target: '1722068142718'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: tool
        targetType: knowledge-retrieval
      id: 1721546630239-source-1722433346222-target
      source: '1721546630239'
      sourceHandle: source
      target: '1722433346222'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: knowledge-retrieval
        targetType: code
      id: 1722433346222-source-1720509395229-target
      source: '1722433346222'
      sourceHandle: source
      target: '1720509395229'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: Start
        type: start
        variables:
        - label: workspace
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: workspace
      height: 90
      id: '1718856016769'
      position:
        x: -3491.2529070238197
        y: 763.7920111462672
      positionAbsolute:
        x: -3491.2529070238197
        y: 763.7920111462672
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - '1722433346222'
          - result
        desc: ''
        model:
          completion_params:
            temperature: 0.2
            top_p: 0.3
          mode: chat
          name: claude-3-5-sonnet-20240620
          provider: anthropic
        prompt_template:
        - id: 9d80a82a-a5c6-4c39-8ad9-3e66ef14be8e
          role: system
          text: "You are a SQL query generator. Your task is to create SQL queries\
            \ based on user requests and the provided database schema. Follow these\
            \ instructions carefully:\n\nAnalyze the user's request, the database\
            \ schema, and the provided term definitions with extreme rigor. Your goal\
            \ is to generate a SQL query that fulfills the user's request using the\
            \ available tables and columns in the database schema, while strictly\
            \ adhering to defined terms and avoiding assumptions.\n\nTo generate the\
            \ SQL query:\n\n1. Rigorously evaluate if the user's request can be answered\
            \ using the provided database schema and term definitions:\n   a. Identify\
            \ all required dimensions, measures, and conditions in the user's query.\n\
            \   b. For each identified element:\n      - First, check if there is\
            \ an exact match in the database schema (table or column name).\n    \
            \  - If not found in the schema, check the <term_definitions> section\
            \ for an exact match.\n      - Do not assume any relationships or meanings\
            \ for terms not explicitly defined in either the schema or <term_definitions>.\n\
            \   c. If a term is defined in <term_definitions>, use only the information\
            \ provided there to determine how to handle it in the query.\n   d. For\
            \ terms found in the schema or <term_definitions>, carefully consider\
            \ data type compatibility.\n   e. If ANY required element is not found\
            \ as an exact match in either the schema or <term_definitions>, immediately\
            \ classify the request as insufficient. Do not attempt to derive or infer\
            \ meanings for undefined terms.\n   f. In case of insufficiency, respond\
            \ with: \"‰ª•ÊàëÂΩìÂâçÁöÑÁü•ËØÜÔºåËøò‰∏çËÉΩÂõûÁ≠îÊÇ®ÁöÑÈóÆÈ¢òÂì¶\", followed by a detailed explanation of\
            \ what specific terms or elements are not recognized, and why the request\
            \ cannot be fulfilled with the current schema and term definitions.\n\
            \   g. Only proceed to SQL generation if ALL required elements are accounted\
            \ for with exact matches, either directly from the schema or through the\
            \ provided term definitions.\n\n2. If the request is valid and properly\
            \ scoped, identify the relevant tables and columns from the schema that\
            \ correspond to the user's request. Use only the elements that have been\
            \ explicitly matched or defined.\n\n3. Determine the appropriate SQL operations\
            \ (SELECT, JOIN, WHERE, GROUP BY, ORDER, etc.) needed to retrieve the\
            \ requested data. For queries returning individual records or comparisons,\
            \ always include an ORDER BY clause to ensure consistent results, and\
            \ use LIMIT to restrict the number of returned rows, typically to 30 or\
            \ less, unless a specific larger number is requested.\n\n4. Construct\
            \ the SQL query using standard SQL syntax. If specific optimizations or\
            \ dialect-specific features (especially for date handling) are available\
            \ for the target database type, utilize them for better efficiency and\
            \ effectiveness. Incorporate calculations or subqueries for derived metrics\
            \ only if they are explicitly defined in <term_definitions>.\n\n5. If\
            \ the query involves time-related conditions, make use of the provided\
            \ current date information.\n\n6. Ensure that the query is optimized and\
            \ follows best practices, including proper handling of any complex calculations\
            \ or derivations based on the explicit term definitions.\n\nImportant:\
            \ If you generate a SQL query, your output must contain ONLY the generated\
            \ SQL query. Do not include any explanations, comments, or additional\
            \ text. The query will be executed directly, so it must be valid SQL syntax.\n\
            \nWrite your SQL query output without any surrounding tags or formatting.\
            \ Ensure it starts with a SQL keyword (e.g., SELECT, WITH, etc.) and ends\
            \ with a semicolon (;)."
        - id: 2076a444-86c2-4663-8b71-a9547dbdfdf5
          role: user
          text: 'here is the database schema information:

            <database_schema>

            {{#1721546630239.text#}}

            </database_schema>

            Additional context for specific terms or metrics: <term_definitions>

            {{#context#}}

            </term_definitions>

            here is the user''s data request:

            <user_request>

            {{#sys.query#}}

            </user_request>

            The target database type is:

            <database_type>

            POSTGRES

            </database_type>


            The current date is:

            <current_date>

            {{#1720509395229.current_date#}}

            </current_date>'
        selected: false
        title: Generate sql
        type: llm
        variables: []
        vision:
          configs:
            detail: high
          enabled: true
      height: 98
      id: llm
      position:
        x: -1307.5389491462806
        y: 654.9731907342522
      positionAbsolute:
        x: -1307.5389491462806
        y: 654.9731907342522
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: d2e37111-f0f5-4e72-a3fb-6df944dcdade
            value: SELECT
            varType: string
            variable_selector:
            - llm
            - text
          id: 'true'
          logical_operator: and
        conditions:
        - comparison_operator: contains
          id: '1718975743597'
          value: SELECT
          variable_selector:
          - llm
          - text
        desc: ''
        logical_operator: and
        selected: false
        title: IF/ELSE 2
        type: if-else
      height: 126
      id: '1718975657163'
      position:
        x: -918.0278832759379
        y: 654.9731907342522
      positionAbsolute:
        x: -918.0278832759379
        y: 654.9731907342522
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#llm.text#}}


          '
        desc: ‰∏çÈúÄË¶ÅÊâßË°åSQLÔºåÁõ¥Êé•ÂõûÁ≠î
        selected: false
        title: direct answer no sql
        type: answer
        variables: []
      height: 135
      id: '1718976692870'
      position:
        x: -369.9830472903312
        y: 800.7833763894674
      positionAbsolute:
        x: -369.9830472903312
        y: 800.7833763894674
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        provider_id: 4d1e02ed-b1ac-47d1-8319-a6f014a1d240
        provider_name: Data Engine
        provider_type: api
        selected: false
        title: execute_sql_post
        tool_configurations: {}
        tool_label: execute_sql_post
        tool_name: execute_sql_post
        tool_parameters:
          sql:
            type: mixed
            value: '{{#llm.text#}}'
          workspace:
            type: mixed
            value: '{{#1718856016769.workspace#}}'
        type: tool
      height: 54
      id: '1720460398281'
      position:
        x: -362.5127102016905
        y: 474.3577238847362
      positionAbsolute:
        x: -362.5127102016905
        y: 474.3577238847362
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\ndef main() -> str:\n    from datetime import date\n    current_date\
          \ = date.today()\n    return {\n        \"current_date\": str(current_date)\n\
          \    }\n"
        code_language: python3
        desc: ''
        outputs:
          current_date:
            children: null
            type: string
        selected: false
        title: current time
        type: code
        variables: []
      height: 54
      id: '1720509395229'
      position:
        x: -1671.4216501201104
        y: 654.9731907342522
      positionAbsolute:
        x: -1671.4216501201104
        y: 654.9731907342522
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1720543282463.text#}}


          '
        desc: ''
        selected: false
        title: execution output
        type: answer
        variables: []
      height: 107
      id: '1720539322719'
      position:
        x: 711.6075882354751
        y: 465.6522182517749
      positionAbsolute:
        x: 711.6075882354751
        y: 465.6522182517749
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.2
            top_p: 0.2
          mode: chat
          name: gpt-4o-mini-2024-07-18
          provider: openai
        prompt_template:
        - id: 838765c1-ba07-4f61-8f18-06439c70c190
          role: system
          text: "‰Ω†ÊòØ‰∏Ä‰∏™AIÂä©Êâã,Ë¥üË¥£‰ª•Êõ¥ÂèãÂ•ΩÁöÑÊ†ºÂºèÂëàÁé∞SQLÊü•ËØ¢‰ø°ÊÅØ„ÄÇ‰Ω†ÁöÑÁõÆÊ†áÊòØ‰ΩøËæìÂá∫Êõ¥ÊòìËØªÂíåÁÆÄÊ¥Å„ÄÇËØ∑‰ªîÁªÜÈÅµÂæ™‰ª•‰∏ãÊåáÁ§∫:\n1. Ê†ºÂºèÂåñSQLËØ≠Âè•:\n\
            Âú®Markdown‰ª£Á†ÅÂùó‰∏≠ËæìÂá∫SQLËØ≠Âè•\nÊîπËøõSQLÁöÑÊ†ºÂºè‰ª•ÊèêÈ´òÂèØËØªÊÄß(‰æãÂ¶Ç,ÈÄÇÂΩìÁöÑÁº©Ëøõ„ÄÅÊç¢Ë°å)\nÁ§∫‰æã:\n```sql\nCopySELECT\
            \ column1, column2 \nFROM table \nWHERE condition;\n```\n2. ËÆ∞‰Ωè:\nÂßãÁªà‰ΩøÁî®MarkdownÊ†ºÂºèÊù•Â±ïÁ§∫ÁªìÊûú„ÄÇ\n\
            Èô§ÈùûÁâπÂà´ÊåáÁ§∫,Âê¶Âàô‰∏çË¶ÅÂåÖÂê´Ëß£ÈáäÊàñÈ¢ùÂ§ñÂõûÁ≠îÔºåÁ°Æ‰øù‰Ω†ÁöÑËæìÂá∫Ê∏ÖÊô∞ÊòìËØª\n\nÂßãÁªàÁî®‰∏≠ÊñáÂõûÁ≠î"
        - id: 46f82c63-c339-42a8-a80a-e1916b70bb85
          role: user
          text: '<sql_statement>

            {{#llm.text#}}

            </sql_statement>'
        selected: false
        title: execution summarize
        type: llm
        variables: []
        vision:
          configs:
            detail: high
          enabled: true
      height: 98
      id: '1720543282463'
      position:
        x: 195.80740200345332
        y: 474.3577238847362
      positionAbsolute:
        x: 195.80740200345332
        y: 474.3577238847362
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.3
            top_p: 0.4
          mode: chat
          name: claude-3-5-sonnet-20240620
          provider: anthropic
        prompt_template:
        - id: e2593233-9320-48fd-8bd3-28d44441ef03
          role: system
          text: "ÊÇ®ÊòØ‰∏Ä‰Ωç‰∫∫Â∑•Êô∫ËÉΩÂä©Êâã,Ë¥üË¥£Â∏ÆÂä©Áî®Êà∑Ê†πÊçÆ‰ªñ‰ª¨ÁöÑËØ∑Ê±ÇÂèØËßÜÂåñÊï∞ÊçÆ„ÄÇ\nÊÇ®ÁöÑÁõÆÊ†áÊòØÂàÜÊûêÊï∞ÊçÆÁªìÊûú,Âπ∂‰ΩøÁî®EChartsÊèê‰æõÈÄÇÂΩìÁöÑÂèØËßÜÂåñ,ÊàñËÄÖÂú®‰∏çÈÄÇÂêàÂèØËßÜÂåñÁöÑÊÉÖÂÜµ‰∏ãÁõ¥Êé•ËæìÂá∫Êï∞ÊçÆ„ÄÇËØ∑ÂßãÁªàÁî®‰∏≠ÊñáÂõûÁ≠î„ÄÇ\n\
            È¶ñÂÖà,ÂàÜÊûêÊï∞ÊçÆÁªìÊûú‰ª•Á°ÆÂÆöÂÖ∂ÊòØÂê¶ÈÄÇÂêàÂèØËßÜÂåñ„ÄÇËÄÉËôë‰ª•‰∏ãÊÉÖÂÜµ:\n1. Â¶ÇÊûúÊï∞ÊçÆÁªìÊûú‰∏∫Á©∫Ôºå‰ªÖËæìÂá∫Ôºö\"Ê≤°ÊúâÊü•ËØ¢Âà∞Êï∞ÊçÆ\"ÔºåÁÑ∂ÂêéÁ´ãÂç≥ÁªìÊùüÂ§ÑÁêÜÔºå‰∏çË¶ÅÊ∑ªÂä†‰ªª‰ΩïËß£ÈáäÊàñÂª∫ËÆÆ„ÄÇ\n\
            2. Â¶ÇÊûúÊï∞ÊçÆÁªìÊûúÊòØÂçï‰∏™ÂÄºÔºåÁõ¥Êé•ËæìÂá∫ËØ•ÂÄº„ÄÇ\n3. Â¶ÇÊûúÊï∞ÊçÆÁªìÊûúÂåÖÂê´Â§öË°åÊï∞ÊçÆÔºå‰∏îÈÄÇÂêàÁî®Ë°®Ê†ºÂ±ïÁ§∫ÁöÑÔºåÁî®MARKDOWNÁöÑÊ†ºÂºèËæìÂá∫Ë°®Ê†º„ÄÇ\n4.\
            \ Â¶ÇÊûúÊï∞ÊçÆÁªìÊûúÂåÖÂê´Â§ö‰∏™Êï∞ÊçÆÁÇπÊàñÂ§çÊùÇÁªìÊûÑÔºåÈÄÇÂêàËøõË°åÂõæË°®Â±ïÁ§∫ÁöÑÊÉÖÂÜµÔºåËØ∑ÁªßÁª≠ËøõË°åÂèØËßÜÂåñ„ÄÇ\n\nÂèØËßÜÂåñËøáÁ®ãËØ∑ÈÅµÂæ™‰ª•‰∏ãÊ≠•È™§:\n1. ÁÆÄË¶ÅËØ¥ÊòéÊÇ®ËÆ°ÂàíÂ¶Ç‰ΩïÂèØËßÜÂåñÊï∞ÊçÆ„ÄÇÊ≥®ÊÑèË¶ÅÈÅµÂæ™Áî®Êà∑ÁöÑËØ∑Ê±ÇÔºåÂèØËßÜÂåñË¶ÅË¥¥ÂêàÁî®Êà∑ËØ∑Ê±Ç‰∏≠ÁöÑË¶ÅÊ±ÇÔºåÊØîÂ¶ÇÂõæË°®Á±ªÂûãÔºåÊó∂Èó¥ËåÉÂõ¥ÔºåÊòæÁ§∫ÁöÑ‰ø°ÊÅØ„ÄÇÂ¶ÇÊûúËØ∑Ê±Ç‰∏≠Ê≤°ÊúâÊòéÁ°ÆËØ¥ÊòéÔºå‰Ω†ÂèØ‰ª•ËøõË°åÊé®Êñ≠„ÄÇ\n\
            2. ÂàõÂª∫EChartsÈÖçÁΩÆ„ÄÇÊ≥®ÊÑèËÄÉËôëÊ∑ªÂä†Â∑•ÂÖ∑ÊèêÁ§∫„ÄÅÂõæ‰æãÂíåÊ†áÁ≠æÁ≠âËßÜËßâÂÖÉÁ¥†‰ª•ÊèêÈ´òÂõæË°®ÁöÑÂèØËØªÊÄß„ÄÇ\n3. Âú®ÈÖçÁΩÆ‰πãÂêé,Êèê‰æõÂõæË°®ÁöÑÁÆÄÁü≠ÊèèËø∞,Ëß£ÈáäÂùêÊ†áËΩ¥ÊàñÂêÑÈÉ®ÂàÜ‰ª£Ë°®ÁöÑÂê´‰πâ„ÄÇ\n\
            ËØ∑‰ª•‰∏ãÈù¢Ê†ºÂºèËæìÂá∫EChartsÈÖçÁΩÆÂ≠óÁ¨¶‰∏≤:\n```chart\n{\n// Your ECharts configuration here\n\
            }\n```\n\nImportantÔºöËØ∑Á°Æ‰øùËæìÂá∫ÁöÑEchartsÈÖçÁΩÆ‰ª•‰∏â‰∏™ÂèçÂºïÂè∑ÂêéË∑ü\"chart\"ÂºÄÂßã,Âπ∂‰ª•‰∏â‰∏™ÂèçÂºïÂè∑ÁªìÊùü.\nÈÄöÂ∏∏ÂÆåÊï¥ÁöÑEchartsÈÖçÁΩÆ‰ºöÂåÖÂê´‰∏ãÈù¢ÂÖÉÁ¥†Ôºö\n\
            1. ÂõæË°®Á±ªÂûã(Â¶ÇÊäòÁ∫øÂõæ„ÄÅÊü±Áä∂Âõæ„ÄÅÈ•ºÂõæ„ÄÅÊï£ÁÇπÂõæ)\n2. ÂåÖÂê´Êèê‰æõÊï∞ÊçÆÁöÑÊï∞ÊçÆÈõÜ,ÊàñÁ≥ªÂàó‰∏≠ÁöÑÊï∞ÊçÆ\n3. XËΩ¥ÂíåYËΩ¥ÈÖçÁΩÆ\n4. Á≥ªÂàóÈÖçÁΩÆ\n\
            5. Â∑•ÂÖ∑ÊèêÁ§∫ÂíåÂõæ‰æã(Â¶ÇÈÄÇÁî®)\n6. ‰ªª‰ΩïÂÖ∂‰ªñÁõ∏ÂÖ≥ÈÄâÈ°π‰ª•ÊîπÂñÑÂèØËßÜÂåñÊïàÊûú\n\nÁ°Æ‰øùÂ∞ΩÈáèË¥¥ÂêàÁî®Êà∑ËØ∑Ê±Ç‰∏≠ÁöÑË¶ÅÊ±ÇÔºåÂ∞§ÂÖ∂ÊòØÂõæË°®Á±ªÂûãÂíåÊó∂Èó¥ËåÉÂõ¥„ÄÇ\n\
            ‰ªÖÂú®ÂÆåÊàêÂèØËßÜÂåñÂêéÔºåÊèê‰æõ‰∏Ä‰∏™ÁÆÄÁü≠ÁöÑÂõæË°®ÊèèËø∞ÔºåËß£ÈáäÂùêÊ†áËΩ¥ÊàñÂêÑÈÉ®ÂàÜ‰ª£Ë°®ÁöÑÂê´‰πâ„ÄÇ‰øùÊåÅËøô‰∏™ÊèèËø∞ÁÆÄÊ¥ÅÔºåÂè™ÂåÖÂê´ÂøÖË¶ÅÁöÑ‰ø°ÊÅØ„ÄÇ\n\n‰ª•‰∏ãÊòØÂ§ÑÁêÜ‰∏çÂêåÊÉÖÂÜµÁöÑ‰∏Ä‰∫õÁ§∫‰æãÔºö\n\
            1. Empty dataset:\n<data_result>\n{\"data\":[]}\n</data_result>\nOutput:\
            \ Êï∞ÊçÆÈõÜ‰∏∫Á©∫\n2. Single value:\n<data_result>\n{\"data\":42}\n</data_result>\n\
            Output: 42\n3. Multiple data points (line chart):\n<data_result>\n{\"\
            data\":[data set goes here]}\n</data_result>\nOutput:\nÊàëÂ∞Ü‰ΩøÁî®ÊäòÁ∫øÂõæÊù•ÂèØËßÜÂåñÊúàÂ∫¶ÈîÄÂîÆÊï∞ÊçÆÔºåxËΩ¥Ë°®Á§∫Êúà‰ªΩÔºåyËΩ¥Ë°®Á§∫ÈîÄÂîÆÈ¢ù„ÄÇ\n\
            ```chart\n{\n\"tooltip\": { \"trigger\": \"axis\" },\n\"dataset\": {\n\
            \"source\": [\n[\"month\", \"sales\"],\n[\"Jan\", 1000],\n[\"Feb\", 1200],\n\
            [\"Mar\", 900],\n[\"Apr\", 1500],\n[\"May\", 1300],\n[\"Jun\", 1700]\n\
            ]\n},\n\"xAxis\": { \"type\": \"category\" },\n\"yAxis\": { \"type\":\
            \ \"value\", \"name\": \"Sales\" },\n\"series\": [\n{\n\"type\": \"line\"\
            ,\n\"encode\": { \"x\": \"month\", \"y\": \"sales\" }\n}\n]\n}\n```\n\
            Ëøô‰∏™ÊäòÁ∫øÂõæÂ±ïÁ§∫‰∫ÜÂÖ≠‰∏™ÊúàÁöÑÈîÄÂîÆË∂ãÂäø„ÄÇÊ®™ËΩ¥ÔºàxËΩ¥ÔºâË°®Á§∫Êúà‰ªΩÔºå‰ªé‰∏ÄÊúàÂà∞ÂÖ≠ÊúàÔºõÁ∫µËΩ¥ÔºàyËΩ¥ÔºâË°®Á§∫ÈîÄÂîÆÈ¢ùÔºåÂçï‰ΩçÂèØËÉΩÊòØÁæéÂÖÉÊàñÂÖ∂‰ªñË¥ßÂ∏Å„ÄÇÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÈîÄÂîÆÈ¢ùÂú®‰∏çÂêåÊúà‰ªΩÊúâÊâÄÊ≥¢Âä®ÔºåÂõõÊúàËææÂà∞‰∫ÜÊúÄÈ´òÁÇπ„ÄÇ\n\
            4. Categorical data (bar chart):\n<data_result>\n{\"data\":[data set goes\
            \ here]}\n</data_result>\nOutput:\nÊàëÂ∞Ü‰ΩøÁî®Êü±Áä∂ÂõæÊù•ÂèØËßÜÂåñ‰∏çÂêå‰∫ßÂìÅÁöÑÈîÄÂîÆÊï∞ÊçÆÔºåxËΩ¥Ë°®Á§∫‰∫ßÂìÅÂêçÁß∞ÔºåyËΩ¥Ë°®Á§∫ÈîÄÂîÆÈ¢ù„ÄÇ\n\
            ```chart\n{\n\"tooltip\": { \"trigger\": \"axis\" },\n\"xAxis\": { \"\
            type\": \"category\" },\n\"yAxis\": { \"type\": \"value\", \"name\": \"\
            Sales\" },\n\"dataset\": {\n\"source\": [\n[\"product\", \"sales\"],\n\
            [\"Matcha Latte\", 43.3],\n[\"Milk Tea\", 83.1],\n[\"Cheese Cocoa\", 86.4],\n\
            [\"Walnut Brownie\", 72.4]\n]\n},\n\"series\": [\n{\n\"type\": \"bar\"\
            ,\n\"encode\": { \"x\": \"product\", \"y\": \"sales\" }\n}\n]\n}\n```\n\
            Ëøô‰∏™Êü±Áä∂ÂõæÂ±ïÁ§∫‰∫ÜÂõõÁßç‰∏çÂêå‰∫ßÂìÅÁöÑÈîÄÂîÆÊÉÖÂÜµ„ÄÇÊ®™ËΩ¥ÔºàxËΩ¥ÔºâË°®Á§∫‰∫ßÂìÅÂêçÁß∞ÔºåÂåÖÊã¨ÊäπËå∂ÊãøÈìÅ„ÄÅÂ•∂Ëå∂„ÄÅËäùÂ£´ÂèØÂèØÂíåÊ†∏Ê°ÉÂ∏ÉÊúóÂ∞ºÔºõÁ∫µËΩ¥ÔºàyËΩ¥ÔºâË°®Á§∫ÈîÄÂîÆÈ¢ùÔºåÂçï‰ΩçÂèØËÉΩÊòØÊï∞ÈáèÊàñÈáëÈ¢ù„ÄÇ‰ªéÂõæ‰∏≠ÂèØ‰ª•ÁúãÂá∫ÔºåËäùÂ£´ÂèØÂèØÁöÑÈîÄÂîÆÈ¢ùÊúÄÈ´òÔºåËÄåÊäπËå∂ÊãøÈìÅÁöÑÈîÄÂîÆÈ¢ùÊúÄ‰Ωé„ÄÇ\n\
            5. Proportional data (pie chart):\n<data_result>\n{\"data\":[data set\
            \ goes here]}\n</data_result>\nOutput:\nÊàëÂ∞Ü‰ΩøÁî®È•ºÂõæÊù•ÂèØËßÜÂåñ‰∏çÂêåÊ∏†ÈÅìÁöÑËÆøÈóÆÈáèÂàÜÂ∏ÉÔºåÊØè‰∏™ÊâáÂΩ¢Âå∫Âüü‰ª£Ë°®‰∏Ä‰∏™Ê∏†ÈÅìÁöÑËÆøÈóÆÈáèÂç†ÊØî„ÄÇ\n\
            ```chart\n{\n\"tooltip\": {\n\"trigger\": \"item\",\n\"formatter\": \"\
            {a} <br/>{b}: {c} ({d}%)\"\n},\n\"legend\": {\n\"orient\": \"vertical\"\
            ,\n\"left\": \"left\"\n},\n\"dataset\": {\n\"source\": [\n[\"category\"\
            , \"value\"],\n[\"Direct\", 335],\n[\"Email\", 310],\n[\"Ad Networks\"\
            , 234],\n[\"Video Ads\", 135],\n[\"Search Engines\", 1548]\n]\n},\n\"\
            series\": [{\n\"name\": \"Access From\",\n\"type\": \"pie\",\n\"radius\"\
            : \"50%\",\n\"encode\": {\n\"itemName\": \"category\",\n\"value\": \"\
            value\"\n},\n\"label\": {\n\"formatter\": \"{b}: {d}%\"\n}\n}]\n}\n```\n\
            Remember to adapt the chart configuration based on the specific data structure\
            \ and user request. Always prioritize clarity and readability in your\
            \ visualizations.\nHere are more knowledge of EChart configuration you\
            \ can refer to when generate complex chart.\n## BAR and LINE Combination\
            \ Chart\noutput:\n```chart\n{\n    \"tooltip\": {\n        \"trigger\"\
            : \"axis\",\n        \"axisPointer\": {\n            \"type\": \"cross\"\
            ,\n            \"crossStyle\": {\n                \"color\": \"#999\"\n\
            \            }\n        }\n    },\n    \"legend\": {\n        \"data\"\
            : [\"Sales\", \"Profit Margin\"]\n    },\n    \"xAxis\": [\n        {\n\
            \            \"type\": \"category\",\n            \"data\": [\"Jan\",\
            \ \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\"\
            , \"Oct\", \"Nov\", \"Dec\"],\n            \"axisPointer\": {\n      \
            \          \"type\": \"shadow\"\n            }\n        }\n    ],\n  \
            \  \"yAxis\": [\n        {\n            \"type\": \"value\",\n       \
            \     \"name\": \"Sales\",\n            \"min\": 0,\n            \"max\"\
            : 250,\n            \"interval\": 50,\n            \"axisLabel\": {\n\
            \                \"formatter\": \"{value} k$\"\n            }\n      \
            \  },\n        {\n            \"type\": \"value\",\n            \"name\"\
            : \"Profit Margin\",\n            \"min\": 0,\n            \"max\": 25,\n\
            \            \"interval\": 5,\n            \"axisLabel\": {\n        \
            \        \"formatter\": \"{value}%\"\n            }\n        }\n    ],\n\
            \    \"series\": [\n        {\n            \"name\": \"Sales\",\n    \
            \        \"type\": \"bar\",\n            \"data\": [120, 132, 101, 134,\
            \ 90, 230, 210, 182, 191, 234, 290, 330]\n        },\n        {\n    \
            \        \"name\": \"Profit Margin\",\n            \"type\": \"line\"\
            ,\n            \"yAxisIndex\": 1,\n            \"data\": [10, 12, 8, 14,\
            \ 7, 18, 15, 13, 14, 16, 20, 22]\n        }\n    ]\n}\n```\n## Line Chart\
            \ with Multiple Y-Axes\nThis example demonstrates a line chart with two\
            \ y-axes, showing temperature and precipitation data for a week.\noutput:\n\
            ```chart\n{\n    \"legend\": { \"data\": [\"Temperature\", \"Precipitation\"\
            ], \"top\": \"top\" },\n    \"tooltip\": { \"trigger\": \"axis\" },\n\
            \    \"dataset\": {\n        \"source\": [\n            [\"date\", \"\
            temperature\", \"precipitation\"],\n            [\"Mon\", 22, 2.6],\n\
            \            [\"Tue\", 24, 5.9],\n            [\"Wed\", 27, 9.0],\n  \
            \          [\"Thu\", 23, 26.4],\n            [\"Fri\", 21, 28.7],\n  \
            \          [\"Sat\", 25, 70.7],\n            [\"Sun\", 26, 175.6]\n  \
            \      ]\n    },\n    \"xAxis\": { \"type\": \"category\" },\n    \"yAxis\"\
            : [\n        { \"type\": \"value\", \"name\": \"Temperature (¬∞C)\", \"\
            position\": \"left\" },\n        { \"type\": \"value\", \"name\": \"Precipitation\
            \ (mm)\", \"position\": \"right\" }\n    ],\n    \"series\": [\n     \
            \   {\n            \"name\": \"Temperature\",\n            \"type\": \"\
            line\",\n            \"encode\": { \"x\": \"date\", \"y\": \"temperature\"\
            \ },\n            \"yAxisIndex\": 0\n        },\n        {\n         \
            \   \"name\": \"Precipitation\",\n            \"type\": \"line\",\n  \
            \          \"encode\": { \"x\": \"date\", \"y\": \"precipitation\" },\n\
            \            \"yAxisIndex\": 1\n        }\n    ]\n}\n```\n## Scatter Plot\n\
            Scatter plots are crucial for visualizing relationships between two variables\
            \ and identifying patterns or correlations.\noutput:\n```chart\n{\n  \
            \  \"tooltip\": {\n        \"trigger\": \"item\",\n        \"formatter\"\
            : function (params) {\n            return 'Height: ' + params.data[0]\
            \ + ' cm<br/>Weight: ' + params.data[1] + ' kg';\n        }\n    },\n\
            \    \"xAxis\": {\n        \"type\": \"value\",\n        \"name\": \"\
            Height (cm)\"\n    },\n    \"yAxis\": {\n        \"type\": \"value\",\n\
            \        \"name\": \"Weight (kg)\"\n    },\n    \"series\": [{\n     \
            \   \"type\": \"scatter\",\n        \"data\": [\n            [168, 65],\
            \ [170, 70], [165, 60], [175, 80], [172, 75],\n            [160, 55],\
            \ [180, 85], [170, 68], [175, 76], [165, 63]\n        ],\n        \"symbolSize\"\
            : 10\n    }]\n}\n```"
        - id: ed423505-66a4-4bb2-84f7-18107ec53ef4
          role: user
          text: 'Here is the user''s data request:

            <user_request>

            {{#sys.query#}}

            </user_request>

            And here is the corresponding data result:

            <data_result>

            {{#1720460398281.text#}}

            </data_result>'
        selected: true
        title: chart prepare
        type: llm
        variables: []
        vision:
          configs:
            detail: high
          enabled: true
      height: 98
      id: '1720642171070'
      position:
        x: 1148.8057080225067
        y: 474.3577238847362
      positionAbsolute:
        x: 1148.8057080225067
        y: 474.3577238847362
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1720642171070.text#}}


          '
        desc: ''
        selected: false
        title: display chart options
        type: answer
        variables: []
      height: 107
      id: '1720642800846'
      position:
        x: 1596.9065154825269
        y: 474.3577238847362
      positionAbsolute:
        x: 1596.9065154825269
        y: 474.3577238847362
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        provider_id: 4d1e02ed-b1ac-47d1-8319-a6f014a1d240
        provider_name: Data Engine
        provider_type: api
        selected: false
        title: workspacemetadata_get
        tool_configurations: {}
        tool_label: workspacemetadata_get
        tool_name: workspacemetadata_get
        tool_parameters:
          workspace:
            type: mixed
            value: '{{#1718856016769.workspace#}}'
        type: tool
      height: 54
      id: '1721546630239'
      position:
        x: -2258.625046633063
        y: 654.9731907342522
      positionAbsolute:
        x: -2258.625046633063
        y: 654.9731907342522
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.5
            top_p: 0.4
          mode: chat
          name: qwen-max-0403
          provider: tongyi
        prompt_template:
        - id: 2afad292-1688-4dbd-99cd-07771fd36a2d
          role: system
          text: "# AIÊï∞ÊçÆÂàÜÊûêÂä©ÊâãÊèêÁ§∫ËØç\n\n‰Ω†ÊòØ‰∏Ä‰ΩçAIÊï∞ÊçÆÂàÜÊûêÂä©ÊâãÔºåË¥üË¥£ÂàùÊ≠•Á≠õÈÄâ‰∏éÊï∞ÊçÆÊü•ËØ¢ÂíåÂàÜÊûêÁõ∏ÂÖ≥ÁöÑÁî®Êà∑ËØ∑Ê±Ç„ÄÇ‰Ω†ÁöÑ‰ªªÂä°ÊòØÂà§Êñ≠ËØ∑Ê±ÇÁöÑÁõ∏ÂÖ≥ÊÄß„ÄÅÂ§çÊùÇÂ∫¶ÂíåÂèØËÉΩÁöÑÊï∞ÊçÆÈáèÔºå‰∏çÊ∂âÂèä‰ªª‰ΩïÂÖ∑‰ΩìÁöÑ‰∏öÂä°ÈÄªËæëÂà§Êñ≠„ÄÇ\n\
            \nËØ∑ÊåâÁÖß‰ª•‰∏ãÊ≠•È™§Â§ÑÁêÜÁî®Êà∑ËØ∑Ê±ÇÔºö\n\n1. ÂàÜÊûêÁî®Êà∑ËØ∑Ê±ÇÔºåÂà§Êñ≠ÊòØÂê¶‰∏éÊï∞ÊçÆÊü•ËØ¢ÊàñÂàÜÊûêÁõ∏ÂÖ≥„ÄÇÂÖ≥Ê≥®Êï∞ÊçÆ„ÄÅÁªüËÆ°„ÄÅÊï∞Â≠óÊàñÂàÜÊûê‰ªªÂä°Áõ∏ÂÖ≥ÁöÑÂÖ≥ÈîÆËØç„ÄÇ\n\n\
            2. Â¶ÇÊûúËØ∑Ê±Ç‰∏éÊï∞ÊçÆÊü•ËØ¢ÊàñÂàÜÊûêÊó†ÂÖ≥ÔºåÂõûÂ§çÔºö\n   \"ÊàëÂè™ËÉΩÂõûÁ≠îÊï∞ÊçÆÊñπÈù¢ÁöÑËØ∑Ê±ÇÂì¶ÔºÅ\"\n\n3. Â¶ÇÊûúËØ∑Ê±ÇÁõ∏ÂÖ≥ÔºåËØÑ‰º∞‰ª•‰∏ã‰∏§ÁÇπÔºö\n\n\
            \   a. Â§çÊùÇÂ∫¶ÔºöÂà§Êñ≠ËØ∑Ê±ÇÊòØÂê¶Â§çÊùÇÂà∞Êó†Ê≥ïÁî®‰∏Ä‰∏™SQLÊü•ËØ¢Âíå‰∏Ä‰∏™ÂõæË°®Êù•ÂõûÁ≠î„ÄÇÂ¶ÇÊûúÊòØÔºåÂõûÂ§çÔºö\n   \"ÊÇ®ÁöÑÈóÆÈ¢òÊØîËæÉÂ§çÊùÇÔºåÂ¶ÇÊûú‰Ω†ËÉΩÁÆÄÂåñ‰∏Ä‰∏ãÔºåÊàñËÄÖÂàÜÊ≠•ÊèêÂá∫ÈóÆÈ¢òÔºåÊàëÂèØËÉΩ‰ºöÂõûÁ≠îÁöÑÊõ¥ÂáÜÁ°ÆÂì¶ÔºÅ\"\
            \n\n   b. Êï∞ÊçÆÈáèÔºöËØÑ‰º∞ËØ∑Ê±ÇÊòØÂê¶ÂèØËÉΩËøîÂõûÂ§ßÈáèÊï∞ÊçÆÔºàÂèØËÉΩË∂ÖËøá1000Êù°ËÆ∞ÂΩïÔºâ„ÄÇ‰ª•‰∏ãÊÉÖÂÜµÂèØËÉΩÂØºËá¥Â§ßÈáèÊï∞ÊçÆËøîÂõûÔºö\n      - ÊåáÂÆöÁöÑÊó∂Èó¥ËåÉÂõ¥ËøáÂ§ßÔºàÂ¶Ç\"\
            ÂéªÂπ¥\"„ÄÅ\"ËøáÂéª‰∏âÂπ¥\"„ÄÅ\"ÊâÄÊúâ\"Á≠âÔºâÔºå‰∏îÊ≤°ÊúâÁî®ËÅöÂêàÔºåÊàñËÄÖËÅöÂêàÁöÑÈ¢óÁ≤íÂ∫¶Â§™ÁªÜÔºåÂØºËá¥ÂèØËÉΩ‰ºöËøîÂõûÂ§ßÈáèÁªìÊûú„ÄÇ\n      - ÈùûËÅöÂêàÁöÑÂÖ®ÈáèÊï∞ÊçÆËØ∑Ê±ÇÔºàÂ¶Ç\"\
            ÊâÄÊúâËÆ∞ÂΩï\"„ÄÅ\"ËØ¶ÁªÜÊï∞ÊçÆ\"Á≠âÔºâ\n   Â¶ÇÊûúÁ¨¶Âêà‰ª•‰∏ä‰ªª‰∏ÄÊÉÖÂÜµÔºåÂõûÂ§çÔºö\n   \"ÊÇ®ÁöÑËØ∑Ê±ÇÂèØËÉΩ‰ºöËøîÂõûÂ§ßÈáèÊï∞ÊçÆ„ÄÇÂª∫ËÆÆÊÇ®Áº©Â∞èÊü•ËØ¢ËåÉÂõ¥ÊàñÂ¢ûÂä†Á≠õÈÄâÊù°‰ª∂Ôºå‰æãÂ¶ÇÊåáÂÆöÊõ¥Â∞èÁöÑÊó∂Èó¥ÊÆµÊàñÊ∑ªÂä†ÂÖ∂‰ªñÈôêÂà∂Êù°‰ª∂„ÄÇ\"\
            \n\n4. Â¶ÇÊûúËØ∑Ê±ÇÊòØÁõ∏ÂÖ≥ÁöÑÊï∞ÊçÆÊü•ËØ¢ÊàñÂàÜÊûêËØ∑Ê±ÇÔºå‰∏î‰∏çÂ≠òÂú®‰∏äËø∞Â§çÊùÇÂ∫¶ÂíåÊï∞ÊçÆÈáèÈóÆÈ¢òÔºåÂàô‰ªÖËæìÂá∫Ôºö\n   VALID REQUEST\n\nÊ≥®ÊÑèÔºöÈô§‰∫Ü‰ª•‰∏äÊåáÂÆöÁöÑÂõûÂ§çÔºå‰∏çË¶ÅÊèê‰æõ‰ªª‰ΩïÂÖ∂‰ªñÂª∫ËÆÆÊàñËß£Èáä„ÄÇÂú®ËæìÂá∫VALID\
            \ REQUESTÊó∂Ôºå‰∏çË¶ÅÊ∑ªÂä†‰ªª‰ΩïÈ¢ùÂ§ñÂÜÖÂÆπ„ÄÇ"
        - id: 5afba990-f2fb-42fc-aa68-032e557fb24f
          role: user
          text: ‰ª•‰∏ãÊòØÁî®Êà∑ËØ∑Ê±Ç:{{#sys.query#}}
        selected: false
        title: request process
        type: llm
        variables: []
        vision:
          enabled: false
      height: 98
      id: '1722064820821'
      position:
        x: -3049.6817627417436
        y: 763.7920111462672
      positionAbsolute:
        x: -3049.6817627417436
        y: 763.7920111462672
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: a5384aee-47a4-411a-9f52-deef9af19cd8
            value: VALID REQUEST
            varType: string
            variable_selector:
            - '1722064820821'
            - text
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: IF/ELSE 3
        type: if-else
      height: 126
      id: '1722068092637'
      position:
        x: -2642.8613718033494
        y: 763.7920111462672
      positionAbsolute:
        x: -2642.8613718033494
        y: 763.7920111462672
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1722064820821.text#}}'
        desc: ''
        selected: false
        title: Answer 7
        type: answer
        variables: []
      height: 107
      id: '1722068142718'
      position:
        x: -2226.4480190267054
        y: 957.6982268439423
      positionAbsolute:
        x: -2226.4480190267054
        y: 957.6982268439423
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        dataset_ids:
        - 7503dbc5-31b9-43b7-a6a1-e0f4bff2b4b4
        desc: ''
        multiple_retrieval_config:
          reranking_model:
            model: ''
            provider: ''
          score_threshold: null
          top_k: 2
        query_variable_selector:
        - sys
        - query
        retrieval_mode: single
        selected: false
        single_retrieval_config:
          model:
            completion_params: {}
            mode: chat
            name: qwen-max-0403
            provider: tongyi
        title: term definitions
        type: knowledge-retrieval
      height: 92
      id: '1722433346222'
      position:
        x: -1947.5977337749903
        y: 545.9561506728106
      positionAbsolute:
        x: -1947.5977337749903
        y: 545.9561506728106
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: 35.08903217071065
      y: -128.8783178578185
      zoom: 0.5366869235799799
